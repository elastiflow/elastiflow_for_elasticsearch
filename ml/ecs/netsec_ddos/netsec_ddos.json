[
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_ddos_tcp_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(client.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'tcp'),type:phrase),query:(match_phrase:(network.transport:'tcp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(client.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'tcp'),type:phrase),query:(match_phrase:(network.transport:'tcp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "TCP DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive Client IPs",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_ddos_tcp_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_ddos_tcp_edge",
      "job_id": "elastiflow_ecs_netsec_ddos_tcp_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "tcp"
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_ddos_tcp_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(client.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'tcp'),type:phrase),query:(match_phrase:(network.transport:'tcp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(client.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'tcp'),type:phrase),query:(match_phrase:(network.transport:'tcp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "TCP DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive Client IPs",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_ddos_tcp_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_ddos_tcp_in",
      "job_id": "elastiflow_ecs_netsec_ddos_tcp_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "tcp"
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_ddos_udp_amplify_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(source.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.port,negate:!f,params:(query:'$source.port$'),type:phrase),query:(match_phrase:(source.port:'$source.port$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(network.transport:'udp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(source.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.port,negate:!f,params:(query:'$source.port$'),type:phrase),query:(match_phrase:(source.port:'$source.port$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(network.transport:'udp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "amplification"
      ],
      "description": "UDP Amplification Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive UDP Responders",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "by_field_name": "destination.ip",
            "partition_field_name": "source.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain",
          "source.port",
          "flow.src.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "3072mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_ddos_udp_amplify_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_ddos_udp_amplify_edge",
      "job_id": "elastiflow_ecs_netsec_ddos_udp_amplify_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "udp"
              }
            },
            {
              "exists": {
                "field": "source.port"
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "terms": {
                "source.port": [
                  17,
                  19,
                  53,
                  69,
                  111,
                  123,
                  137,
                  161,
                  389,
                  520,
                  751,
                  1434,
                  1645,
                  1646,
                  1812,
                  1813,
                  1900,
                  3702,
                  5093,
                  5353,
                  11211,
                  27015,
                  27960
                ]
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_ddos_udp_amplify_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(source.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.port,negate:!f,params:(query:'$source.port$'),type:phrase),query:(match_phrase:(source.port:'$source.port$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(network.transport:'udp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.as.organization.name,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(source.as.organization.name:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.port,negate:!f,params:(query:'$source.port$'),type:phrase),query:(match_phrase:(source.port:'$source.port$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(network.transport:'udp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "amplification"
      ],
      "description": "UDP Amplification Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive UDP Responders",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "by_field_name": "destination.ip",
            "partition_field_name": "source.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain",
          "source.port",
          "flow.src.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "3072mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_ddos_udp_amplify_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_ddos_udp_amplify_in",
      "job_id": "elastiflow_ecs_netsec_ddos_udp_amplify_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "udp"
              }
            },
            {
              "exists": {
                "field": "source.port"
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "terms": {
                "source.port": [
                  17,
                  19,
                  53,
                  69,
                  111,
                  123,
                  137,
                  161,
                  389,
                  520,
                  751,
                  1434,
                  1645,
                  1646,
                  1812,
                  1813,
                  1900,
                  3702,
                  5093,
                  5353,
                  11211,
                  27015,
                  27960
                ]
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_ddos_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_ddos_edge",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_ddos_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_ddos_in",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood DDoS Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_ddos_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_ddos_out",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood DDoS Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_ddos_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_ddos_priv",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_ddos_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$source.ip$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood Direct Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "over_field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "source.ip",
          "source.domain",
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_direct_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_direct_edge",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$source.ip$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood Direct Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "over_field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "source.ip",
          "source.domain",
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_direct_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_direct_in",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood Direct Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "over_field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "source.ip",
          "source.domain",
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_direct_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_direct_out",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "source.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "destination.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:network.transport,negate:!f,params:(query:'icmp'),type:phrase),query:(match_phrase:(network.transport:'icmp'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:destination.ip,negate:!f,params:(query:'$destination.ip$'),type:phrase),query:(match_phrase:(destination.ip:'$destination.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:source.ip,negate:!f,params:(query:'$source.ip$'),type:phrase),query:(match_phrase:(source.ip:'$source.ip$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "ICMP Flood Direct Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "over_field_name": "source.ip",
            "partition_field_name": "destination.ip",
            "detector_index": 0
          }
        ],
        "influencers": [
          "source.ip",
          "source.domain",
          "destination.ip",
          "destination.domain"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_icmp_flood_direct_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_icmp_flood_direct_priv",
      "job_id": "elastiflow_ecs_netsec_icmp_flood_direct_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "network.transport": "icmp"
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "source.ip"
              }
            },
            {
              "exists": {
                "field": "destination.ip"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "source.ip": []
              }
            },
            {
              "terms": {
                "destination.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_ddos_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_ddos_edge",
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_ddos_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_ddos_in",
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood DDoS Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_ddos_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_ddos_out",
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood DDoS Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "client.ip",
            "by_field_name": "server.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_ddos_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_ddos_priv",
      "job_id": "elastiflow_ecs_netsec_syn_flood_ddos_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$client.ip$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood Direct Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "by_field_name": "server.ip",
            "over_field_name": "client.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "client.ip",
          "client.domain",
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_direct_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_direct_edge",
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$client.ip$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood Direct Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "by_field_name": "server.ip",
            "over_field_name": "client.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "client.ip",
          "client.domain",
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_direct_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_direct_in",
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood Direct Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "by_field_name": "server.ip",
            "over_field_name": "client.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "client.ip",
          "client.domain",
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_direct_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_direct_out",
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "client.as.organization.name": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "server.as.organization.name": "PRIVATE"
              }
            },
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:event.dataset,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(event.dataset:ipfix)),(match_phrase:(event.dataset:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.ip,negate:!f,params:(query:'$server.ip$'),type:phrase),query:(match_phrase:(server.ip:'$server.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:client.ip,negate:!f,params:(query:'$client.ip$'),type:phrase),query:(match_phrase:(client.ip:'$client.ip$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-ecs-*',key:server.port,negate:!f,params:(query:'$server.port$'),type:phrase),query:(match_phrase:(server.port:'$server.port$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood"
      ],
      "description": "SYN Flood Direct Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "network.packets",
            "by_field_name": "server.ip",
            "over_field_name": "client.ip",
            "partition_field_name": "server.port",
            "detector_index": 0
          }
        ],
        "influencers": [
          "client.ip",
          "client.domain",
          "server.ip",
          "server.domain",
          "server.port"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_ecs_netsec_syn_flood_direct_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_ecs_netsec_syn_flood_direct_priv",
      "job_id": "elastiflow_ecs_netsec_syn_flood_direct_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "event.dataset": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "client.ip"
              }
            },
            {
              "exists": {
                "field": "server.ip"
              }
            },
            {
              "exists": {
                "field": "server.port"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "client.ip": []
              }
            },
            {
              "terms": {
                "server.ip": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-ecs-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  }
]