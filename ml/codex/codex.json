[
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dhcp_broadcast_high",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DHCP)",
            "url_value": "dashboards#/view/a9f3e040-9b94-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'255.255.255.255'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'255.255.255.255'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:68),type:phrase),query:(match_phrase:(flow.src.l4.port.id:68))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'255.255.255.255'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'255.255.255.255'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:68),type:phrase),query:(match_phrase:(flow.src.l4.port.id:68))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'255.255.255.255'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'255.255.255.255'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:68),type:phrase),query:(match_phrase:(flow.src.l4.port.id:68))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "High DHCP Broadcast Messages",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High DHCP Broadcast Messages",
            "function": "high_sum",
            "field_name": "flow.packets",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dhcp_broadcast_high",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dhcp_broadcast_high",
      "job_id": "elastiflow_codex_avail_dhcp_broadcast_high",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 68
              }
            },
            {
              "term": {
                "flow.dst.l4.port.id": 67
              }
            },
            {
              "term": {
                "flow.dst.ip.addr": "255.255.255.255"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dhcp_relay_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DHCP)",
            "url_value": "dashboards#/view/a9f3e040-9b94-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low DHCP Relayed Messages",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Low DHCP Relayed Messages",
            "function": "low_count",
            "by_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dhcp_relay_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dhcp_relay_low",
      "job_id": "elastiflow_codex_avail_dhcp_relay_low",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 67
              }
            },
            {
              "term": {
                "flow.dst.l4.port.id": 67
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dhcp_resp_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DHCP)",
            "url_value": "dashboards#/view/a9f3e040-9b94-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.src.l4.port.id:67))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:67),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low DHCP Responses",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Low DHCP Responses",
            "function": "low_count",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dhcp_resp_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dhcp_resp_low",
      "job_id": "elastiflow_codex_avail_dhcp_resp_low",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 67
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.l4.port.id": 67
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dhcp_resp_ratio_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DHCP)",
            "url_value": "dashboards#/view/a9f3e040-9b94-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.server.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.server.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:67),type:phrase),query:(match_phrase:(flow.server.l4.port.id:67)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low DHCP Request/Response Ratio",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "summary_count_field_name": "doc_count",
        "detectors": [
          {
            "detector_description": "Low DHCP Request/Response Ratio",
            "function": "low_mean",
            "field_name": "ratio",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dhcp_resp_ratio_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dhcp_resp_ratio_low",
      "job_id": "elastiflow_codex_avail_dhcp_resp_ratio_low",
      "chunking_config": {
        "mode": "auto"
      },
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.server.l4.port.id": 67
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.l4.port.id": 67
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "aggregations": {
        "buckets": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "20m",
            "time_zone": "UTC"
          },
          "aggregations": {
            "@timestamp": {
              "max": {
                "field": "@timestamp"
              }
            },
            "flow.server.ip.addr": {
              "terms": {
                "field": "flow.server.ip.addr",
                "size": 20000
              },
              "aggregations": {
                "requests": {
                  "filter": {
                    "term": {
                      "flow.dst.l4.port.id": 67
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "responses": {
                  "filter": {
                    "term": {
                      "flow.src.l4.port.id": 67
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "ratio": {
                  "bucket_script": {
                    "buckets_path": {
                      "requests": "requests.packets",
                      "responses": "responses.packets"
                    },
                    "script": "if(params.requests>0){params.responses/params.requests}else{1}"
                  }
                }
              }
            }
          }
        }
      },
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dns_resp_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DNS)",
            "url_value": "dashboards#/view/61bf2aa0-9b2b-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.src.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.src.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.src.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low DNS Responses",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Low DNS Responses",
            "function": "low_count",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dns_resp_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dns_resp_low",
      "job_id": "elastiflow_codex_avail_dns_resp_low",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 53
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_dns_resp_ratio_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (DNS)",
            "url_value": "dashboards#/view/61bf2aa0-9b2b-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.server.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.server.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:53),type:phrase),query:(match_phrase:(flow.server.l4.port.id:53)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low DNS Request/Response Ratio",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "summary_count_field_name": "doc_count",
        "detectors": [
          {
            "detector_description": "Low DNS Request/Response Ratio",
            "function": "low_mean",
            "field_name": "ratio",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_dns_resp_ratio_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_dns_resp_ratio_low",
      "job_id": "elastiflow_codex_avail_dns_resp_ratio_low",
      "chunking_config": {
        "mode": "auto"
      },
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.server.l4.port.id": 53
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "aggregations": {
        "buckets": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "20m",
            "time_zone": "UTC"
          },
          "aggregations": {
            "@timestamp": {
              "max": {
                "field": "@timestamp"
              }
            },
            "flow.server.ip.addr": {
              "terms": {
                "field": "flow.server.ip.addr",
                "size": 20000
              },
              "aggregations": {
                "requests": {
                  "filter": {
                    "term": {
                      "flow.dst.l4.port.id": 53
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "responses": {
                  "filter": {
                    "term": {
                      "flow.src.l4.port.id": 53
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "ratio": {
                  "bucket_script": {
                    "buckets_path": {
                      "requests": "requests.packets",
                      "responses": "responses.packets"
                    },
                    "script": "if(params.requests>0){params.responses/params.requests}else{1}"
                  }
                }
              }
            }
          }
        }
      },
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_ldap_resp_ratio_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (LDAP)",
            "url_value": "dashboards#/view/0ae30960-c31a-11ec-aaf3-5b4644130c7f?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:389),type:phrase),query:(match_phrase:(flow.server.l4.port.id:389)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:389),type:phrase),query:(match_phrase:(flow.server.l4.port.id:389)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:389),type:phrase),query:(match_phrase:(flow.server.l4.port.id:389)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low LDAP Request/Response Ratio",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "summary_count_field_name": "doc_count",
        "detectors": [
          {
            "detector_description": "Low LDAP Request/Response Ratio",
            "function": "low_mean",
            "field_name": "ratio",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_ldap_resp_ratio_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_ldap_resp_ratio_low",
      "job_id": "elastiflow_codex_avail_ldap_resp_ratio_low",
      "chunking_config": {
        "mode": "auto"
      },
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.server.l4.port.id": 389
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "aggregations": {
        "buckets": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "20m",
            "time_zone": "UTC"
          },
          "aggregations": {
            "@timestamp": {
              "max": {
                "field": "@timestamp"
              }
            },
            "flow.server.ip.addr": {
              "terms": {
                "field": "flow.server.ip.addr",
                "size": 20000
              },
              "aggregations": {
                "requests": {
                  "filter": {
                    "term": {
                      "flow.dst.l4.port.id": 389
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "responses": {
                  "filter": {
                    "term": {
                      "flow.src.l4.port.id": 389
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "ratio": {
                  "bucket_script": {
                    "buckets_path": {
                      "requests": "requests.packets",
                      "responses": "responses.packets"
                    },
                    "script": "if(params.requests>0){params.responses/params.requests}else{1}"
                  }
                }
              }
            }
          }
        }
      },
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_ntp_resp_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (NTP)",
            "url_value": "dashboards#/view/e2888380-9d73-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!t,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low NTP Responses",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Low NTP Responses",
            "function": "low_count",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "256mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_ntp_resp_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_ntp_resp_low",
      "job_id": "elastiflow_codex_avail_ntp_resp_low",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 123
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.l4.port.id": 123
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_ntp_resp_ratio_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (NTP)",
            "url_value": "dashboards#/view/e2888380-9d73-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.server.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.server.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.server.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low NTP Request/Response Ratio",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "summary_count_field_name": "doc_count",
        "detectors": [
          {
            "detector_description": "Low NTP Request/Response Ratio",
            "function": "low_mean",
            "field_name": "ratio",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "256mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_ntp_resp_ratio_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_ntp_resp_ratio_low",
      "job_id": "elastiflow_codex_avail_ntp_resp_ratio_low",
      "chunking_config": {
        "mode": "auto"
      },
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.server.l4.port.id": 123
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.l4.port.id": 123
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "aggregations": {
        "buckets": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "20m",
            "time_zone": "UTC"
          },
          "aggregations": {
            "@timestamp": {
              "max": {
                "field": "@timestamp"
              }
            },
            "flow.server.ip.addr": {
              "terms": {
                "field": "flow.server.ip.addr",
                "size": 20000
              },
              "aggregations": {
                "requests": {
                  "filter": {
                    "term": {
                      "flow.dst.l4.port.id": 123
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "responses": {
                  "filter": {
                    "term": {
                      "flow.src.l4.port.id": 123
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "flow.packets"
                      }
                    }
                  }
                },
                "ratio": {
                  "bucket_script": {
                    "buckets_path": {
                      "requests": "requests.packets",
                      "responses": "responses.packets"
                    },
                    "script": "if(params.requests>0){params.responses/params.requests}else{1}"
                  }
                }
              }
            }
          }
        }
      },
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_ntp_sym_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (NTP)",
            "url_value": "dashboards#/view/e2888380-9d73-11ec-a4df-e940aaa4214d?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.src.l4.port.id:123))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.l4.port.id,negate:!f,params:(query:123),type:phrase),query:(match_phrase:(flow.dst.l4.port.id:123)))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low NTP Symmetric Messages",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Low NTP Symmetric Messages",
            "function": "low_count",
            "by_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "256mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_ntp_sym_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_ntp_sym_low",
      "job_id": "elastiflow_codex_avail_ntp_sym_low",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "term": {
                "flow.src.l4.port.id": 123
              }
            },
            {
              "term": {
                "flow.dst.l4.port.id": 123
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_radius_auth_resp_ratio_low",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Core Services (RADIUS)",
            "url_value": "dashboards#/view/c47f5d40-aad5-11ec-a53b-a13fb63fe954?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:!('1812','1645'),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.server.l4.port.id:'1812')),(match_phrase:(flow.server.l4.port.id:'1645')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(l4.proto.name:'udp')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:!('1812','1645'),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.server.l4.port.id:'1812')),(match_phrase:(flow.server.l4.port.id:'1645')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(l4.proto.name:'udp')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:!('1812','1645'),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.server.l4.port.id:'1812')),(match_phrase:(flow.server.l4.port.id:'1645')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'udp'),type:phrase),query:(match_phrase:(l4.proto.name:'udp')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "network_services"
      ],
      "description": "Low RADIUS AUTH Request/Response Ratio",
      "analysis_config": {
        "bucket_span": "20m",
        "model_prune_window": "14d",
        "summary_count_field_name": "doc_count",
        "detectors": [
          {
            "detector_description": "Low RADIUS AUTH Request/Response Ratio",
            "function": "low_mean",
            "field_name": "ratio",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_radius_auth_resp_ratio_low",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_radius_auth_resp_ratio_low",
      "job_id": "elastiflow_codex_avail_radius_auth_resp_ratio_low",
      "chunking_config": {
        "mode": "auto"
      },
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "term": {
                "l4.proto.name": "udp"
              }
            },
            {
              "terms": {
                "flow.server.l4.port.id": [
                  1645,
                  1812
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "aggregations": {
        "buckets": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "20m",
            "time_zone": "UTC"
          },
          "aggregations": {
            "@timestamp": {
              "max": {
                "field": "@timestamp"
              }
            },
            "flow.server.ip.addr": {
              "terms": {
                "field": "flow.server.ip.addr",
                "size": 20000
              },
              "aggregations": {
                "requests": {
                  "filter": {
                    "terms": {
                      "flow.dst.l4.port.id": [
                        1645,
                        1812
                      ]
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "network.packets"
                      }
                    }
                  }
                },
                "responses": {
                  "filter": {
                    "terms": {
                      "flow.src.l4.port.id": [
                        1645,
                        1812
                      ]
                    }
                  },
                  "aggregations": {
                    "packets": {
                      "sum": {
                        "field": "network.packets"
                      }
                    }
                  }
                },
                "ratio": {
                  "bucket_script": {
                    "buckets_path": {
                      "requests": "requests.packets",
                      "responses": "responses.packets"
                    },
                    "script": "if(params.requests>0){params.responses/params.requests}else{1}"
                  }
                }
              }
            }
          }
        }
      },
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "edge"
      ],
      "description": "Failed TCP Sessions - edge",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Unestablished Connections",
            "function": "high_count",
            "by_field_name": "flow.server.l4.port.name",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_tcp_sess_fails_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_tcp_sess_fails_edge",
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "term": {
                "l4.session.established": "false"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.name"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": [
                  "169.254.0.0/16",
                  "fe80::/10"
                ]
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "inbound"
      ],
      "description": "Failed TCP Sessions - inbound",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Unestablished Connections",
            "function": "high_count",
            "by_field_name": "flow.server.l4.port.name",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_tcp_sess_fails_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_tcp_sess_fails_in",
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "term": {
                "l4.session.established": "false"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.name"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": [
                  "169.254.0.0/16",
                  "fe80::/10"
                ]
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "outbound"
      ],
      "description": "Failed TCP Sessions - outbound",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Unestablished Connections",
            "function": "high_count",
            "by_field_name": "flow.server.l4.port.name",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_tcp_sess_fails_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_tcp_sess_fails_out",
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "term": {
                "l4.session.established": "false"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.name"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": [
                  "169.254.0.0/16",
                  "fe80::/10"
                ]
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "availability",
        "private"
      ],
      "description": "Failed TCP Sessions - private",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Unestablished Connections",
            "function": "high_count",
            "by_field_name": "flow.server.l4.port.name",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_avail_tcp_sess_fails_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_avail_tcp_sess_fails_priv",
      "job_id": "elastiflow_codex_avail_tcp_sess_fails_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "term": {
                "l4.session.established": "false"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.name"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": [
                  "169.254.0.0/16",
                  "fe80::/10"
                ]
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "fast"
      ],
      "description": "Brute Force Direct CLI Access - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_edge_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "slow"
      ],
      "description": "Brute Force Direct CLI Access - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_edge_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "fast"
      ],
      "description": "Brute Force Direct CLI Access - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_in_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "slow"
      ],
      "description": "Brute Force Direct CLI Access - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_in_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "fast"
      ],
      "description": "Brute Force Direct CLI Access - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_out_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "slow"
      ],
      "description": "Brute Force Direct CLI Access - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_out_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "fast"
      ],
      "description": "Brute Force Direct CLI Access - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_priv_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "slow"
      ],
      "description": "Brute Force Direct CLI Access - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_cli_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_cli_priv_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_cli_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "fast"
      ],
      "description": "Brute Force Direct Remote Desktop Access - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_edge_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "slow"
      ],
      "description": "Brute Force Direct Remote Desktop Access - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_edge_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "fast"
      ],
      "description": "Brute Force Direct Remote Desktop Access - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_in_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "slow"
      ],
      "description": "Brute Force Direct Remote Desktop Access - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_in_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "fast"
      ],
      "description": "Brute Force Direct Remote Desktop Access - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_out_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "slow"
      ],
      "description": "Brute Force Direct Remote Desktop Access - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_out_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "fast"
      ],
      "description": "Brute Force Direct Remote Desktop Access - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_priv_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "slow"
      ],
      "description": "Brute Force Direct Remote Desktop Access - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Access Attempts",
            "function": "high_distinct_count",
            "field_name": "flow.client.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_direct_desktop_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_direct_desktop_priv_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_direct_desktop_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.client.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "fast"
      ],
      "description": "Brute Force Distributed CLI Access - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_edge_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "slow"
      ],
      "description": "Brute Force Distributed CLI Access - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_edge_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "fast"
      ],
      "description": "Brute Force Distributed CLI Access - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_in_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "slow"
      ],
      "description": "Brute Force Distributed CLI Access - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_in_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "fast"
      ],
      "description": "Brute Force Distributed CLI Access - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_out_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "slow"
      ],
      "description": "Brute Force Distributed CLI Access - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_out_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "fast"
      ],
      "description": "Brute Force Distributed CLI Access - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_priv_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "slow"
      ],
      "description": "Brute Force Distributed CLI Access - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_cli_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_cli_priv_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_cli_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "terms": {
                "flow.server.l4.port.id": [
                  22,
                  23
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "fast"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "edge",
        "slow"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "fast"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_in_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "inbound",
        "slow"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_in_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "fast"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_out_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "outbound",
        "slow"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_out_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "fast"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_fast",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Conversations",
            "url_value": "dashboards#/view/c2da3880-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "access",
        "bruteforce",
        "private",
        "slow"
      ],
      "description": "Brute Force Distributed Remote Desktop Access - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Clients",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_slow",
      "job_id": "elastiflow_codex_netsec_bruteforce_distrib_desktop_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "flow.server.l4.port.id": [
                        1494,
                        3389
                      ]
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "5900",
                        "lte": "5904"
                      }
                    }
                  },
                  {
                    "range": {
                      "flow.server.l4.port.id": {
                        "gte": "6000",
                        "lte": "6063"
                      }
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_ddos_tcp_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'TCP'),type:phrase),query:(match_phrase:(l4.proto.name:'TCP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'TCP'),type:phrase),query:(match_phrase:(l4.proto.name:'TCP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "edge"
      ],
      "description": "TCP DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Client IPs",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_ddos_tcp_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_ddos_tcp_edge",
      "job_id": "elastiflow_codex_netsec_ddos_tcp_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_ddos_tcp_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'TCP'),type:phrase),query:(match_phrase:(l4.proto.name:'TCP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'TCP'),type:phrase),query:(match_phrase:(l4.proto.name:'TCP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.name,negate:!f,params:(query:'$flow.server.l4.port.name$'),type:phrase),query:(match_phrase:(flow.server.l4.port.name:'$flow.server.l4.port.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "inbound"
      ],
      "description": "TCP DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive Client IPs",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_ddos_tcp_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_ddos_tcp_in",
      "job_id": "elastiflow_codex_netsec_ddos_tcp_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "TCP"
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_ddos_udp_amplify_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:'$flow.src.l4.port.id$'),type:phrase),query:(match_phrase:(flow.src.l4.port.id:'$flow.src.l4.port.id$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:'$flow.src.l4.port.id$'),type:phrase),query:(match_phrase:(flow.src.l4.port.id:'$flow.src.l4.port.id$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "amplification",
        "edge"
      ],
      "description": "UDP Amplification Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive UDP Responders",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "by_field_name": "flow.dst.ip.addr",
            "partition_field_name": "flow.src.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.src.l4.port.id",
          "flow.src.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "3072mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_ddos_udp_amplify_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_ddos_udp_amplify_edge",
      "job_id": "elastiflow_codex_netsec_ddos_udp_amplify_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "exists": {
                "field": "flow.src.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "flow.src.l4.port.id": [
                  17,
                  19,
                  53,
                  69,
                  111,
                  123,
                  137,
                  161,
                  389,
                  520,
                  751,
                  1434,
                  1645,
                  1646,
                  1812,
                  1813,
                  1900,
                  3702,
                  5093,
                  5353,
                  11211,
                  27015,
                  27960
                ]
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_ddos_udp_amplify_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:'$flow.src.l4.port.id$'),type:phrase),query:(match_phrase:(flow.src.l4.port.id:'$flow.src.l4.port.id$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.l4.port.id,negate:!f,params:(query:'$flow.src.l4.port.id$'),type:phrase),query:(match_phrase:(flow.src.l4.port.id:'$flow.src.l4.port.id$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'UDP'),type:phrase),query:(match_phrase:(l4.proto.name:'UDP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "amplification",
        "inbound"
      ],
      "description": "UDP Amplification Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive UDP Responders",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "by_field_name": "flow.dst.ip.addr",
            "partition_field_name": "flow.src.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.src.l4.port.id",
          "flow.src.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "3072mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_ddos_udp_amplify_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_ddos_udp_amplify_in",
      "job_id": "elastiflow_codex_netsec_ddos_udp_amplify_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "UDP"
              }
            },
            {
              "exists": {
                "field": "flow.src.l4.port.id"
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "flow.src.l4.port.id": [
                  17,
                  19,
                  53,
                  69,
                  111,
                  123,
                  137,
                  161,
                  389,
                  520,
                  751,
                  1434,
                  1645,
                  1646,
                  1812,
                  1813,
                  1900,
                  3702,
                  5093,
                  5353,
                  11211,
                  27015,
                  27960
                ]
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "edge"
      ],
      "description": "ICMP Flood DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_ddos_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_ddos_edge",
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "inbound"
      ],
      "description": "ICMP Flood DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_ddos_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_ddos_in",
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "outbound"
      ],
      "description": "ICMP Flood DDoS Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_ddos_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_ddos_out",
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "private"
      ],
      "description": "ICMP Flood DDoS Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Sources",
            "function": "high_distinct_count",
            "field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_ddos_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_ddos_priv",
      "job_id": "elastiflow_codex_netsec_icmp_flood_ddos_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "edge"
      ],
      "description": "ICMP Flood Direct Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "over_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_direct_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_direct_edge",
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "inbound"
      ],
      "description": "ICMP Flood Direct Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "over_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_direct_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_direct_in",
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "outbound"
      ],
      "description": "ICMP Flood Direct Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "over_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_direct_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_direct_out",
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:(query:'ICMP'),type:phrase),query:(match_phrase:(l4.proto.name:'ICMP'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.ip.addr,negate:!f,params:(query:'$flow.dst.ip.addr$'),type:phrase),query:(match_phrase:(flow.dst.ip.addr:'$flow.dst.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "private"
      ],
      "description": "ICMP Flood Direct Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive ICMP Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "over_field_name": "flow.src.ip.addr",
            "partition_field_name": "flow.dst.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_flood_direct_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_flood_direct_priv",
      "job_id": "elastiflow_codex_netsec_icmp_flood_direct_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "l4.proto.name": "ICMP"
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "fast"
      ],
      "description": "ICMP Scan Direct - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_edge_fast",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "slow"
      ],
      "description": "ICMP Scan Direct - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_edge_slow",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.dst.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "fast"
      ],
      "description": "ICMP Scan Direct - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_in_fast",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.src.ip.addr$"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.dst.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "slow"
      ],
      "description": "ICMP Scan Direct - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_in_slow",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.dst.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "fast"
      ],
      "description": "ICMP Scan Direct - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_out_fast",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.dst.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.src.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "slow"
      ],
      "description": "ICMP Scan Direct - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_out_slow",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.src.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.dst.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "fast"
      ],
      "description": "ICMP Scan Direct - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_priv_fast",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/bf9f8a70-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.ip.addr,negate:!f,params:(query:'$flow.src.ip.addr$'),type:phrase),query:(match_phrase:(flow.src.ip.addr:'$flow.src.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:l4.proto.name,negate:!f,params:!(ICMP,IPv6-ICMP),type:phrases),query:(bool:(minimum_should_match:1,should:!((match_phrase:(l4.proto.name:'ICMP')),(match_phrase:(l4.proto.name:'IPv6-ICMP')))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:icmp.type.name,negate:!f,params:(query:'Echo'),type:phrase),query:(match_phrase:(icmp.type.name:'Echo'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "slow"
      ],
      "description": "ICMP Scan Direct - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Destination IPs",
            "function": "high_distinct_count",
            "field_name": "flow.dst.ip.addr",
            "over_field_name": "flow.src.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.ip.addr",
          "flow.src.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_icmp_scan_direct_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_icmp_scan_direct_priv_slow",
      "job_id": "elastiflow_codex_netsec_icmp_scan_direct_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.dst.ip.addr"
              }
            },
            {
              "terms": {
                "l4.proto.name": [
                  "ICMP",
                  "IPv6-ICMP"
                ]
              }
            },
            {
              "term": {
                "icmp.type.name": "Echo"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.src.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.dst.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "fast"
      ],
      "description": "Port Scan Direct - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_edge_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "slow"
      ],
      "description": "Port Scan Direct - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_edge_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "fast"
      ],
      "description": "Port Scan Direct - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "4096mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_in_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "slow"
      ],
      "description": "Port Scan Direct - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "4096mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_in_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "fast"
      ],
      "description": "Port Scan Direct - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_out_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "slow"
      ],
      "description": "Port Scan Direct - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_out_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "fast"
      ],
      "description": "Port Scan Direct - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_priv_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_direct_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "slow"
      ],
      "description": "Port Scan Direct - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_direct_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_direct_priv_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_direct_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_edge_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "fast"
      ],
      "description": "Port Scan Distributed - edge (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_edge_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_edge_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_edge_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_edge_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "edge",
        "slow"
      ],
      "description": "Port Scan Distributed - edge (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_edge_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_edge_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_edge_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_in_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "fast"
      ],
      "description": "Port Scan Distributed - inbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_in_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_in_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_in_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_in_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "inbound",
        "slow"
      ],
      "description": "Port Scan Distributed - inbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_in_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_in_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_in_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_out_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "fast"
      ],
      "description": "Port Scan Distributed - outbound (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_out_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_out_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_out_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_out_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.org,negate:!t,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.server.as.org:'PRIVATE'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.org,negate:!f,params:(query:'PRIVATE'),type:phrase),query:(match_phrase:(flow.client.as.org:'PRIVATE')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "outbound",
        "slow"
      ],
      "description": "Port Scan Distributed - outbound (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_out_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_out_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_out_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_priv_fast",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "fast"
      ],
      "description": "Port Scan Distributed - private (fast)",
      "analysis_config": {
        "bucket_span": "10m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_priv_fast",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_priv_fast",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_priv_fast",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_priv_slow",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.locality,negate:!f,params:(query:'private'),type:phrase),query:(match_phrase:(flow.locality:'private')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "reconnaissance",
        "private",
        "slow"
      ],
      "description": "Port Scan Distributed - private (slow)",
      "analysis_config": {
        "bucket_span": "240m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "High Unique Ports Attempted",
            "function": "high_distinct_count",
            "field_name": "flow.server.l4.port.id",
            "partition_field_name": "flow.server.ip.addr",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_port_scan_distrib_priv_slow",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_port_scan_distrib_priv_slow",
      "job_id": "elastiflow_codex_netsec_port_scan_distrib_priv_slow",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": [
                  "255.255.255.255"
                ]
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_asn_client",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.label,negate:!f,params:(query:'$flow.client.as.label$'),type:phrase),query:(match_phrase:(flow.client.as.label:'$flow.client.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.label,negate:!f,params:(query:'$flow.client.as.label$'),type:phrase),query:(match_phrase:(flow.client.as.label:'$flow.client.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.as.label,negate:!f,params:(query:'$flow.client.as.label$'),type:phrase),query:(match_phrase:(flow.client.as.label:'$flow.client.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity"
      ],
      "description": "Rare Client-Side Autonomous System",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare ASN",
            "function": "rare",
            "by_field_name": "flow.client.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.as.label",
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_asn_client",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_asn_client",
      "job_id": "elastiflow_codex_netsec_rare_asn_client",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.as.label"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_asn_server",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.label,negate:!f,params:(query:'$flow.server.as.label$'),type:phrase),query:(match_phrase:(flow.server.as.label:'$flow.server.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.label,negate:!f,params:(query:'$flow.server.as.label$'),type:phrase),query:(match_phrase:(flow.server.as.label:'$flow.server.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.as.label,negate:!f,params:(query:'$flow.server.as.label$'),type:phrase),query:(match_phrase:(flow.server.as.label:'$flow.server.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity"
      ],
      "description": "Rare Server-Side Autonomous System",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare ASN",
            "function": "rare",
            "by_field_name": "flow.server.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.as.label",
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_asn_server",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_asn_server",
      "job_id": "elastiflow_codex_netsec_rare_asn_server",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.server.as.label"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_conversation_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "inbound"
      ],
      "description": "Rare Conversation - inbound",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Conversation",
            "function": "rare",
            "by_field_name": "flow.conversation.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.conversation.id",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_conversation_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_conversation_in",
      "job_id": "elastiflow_codex_netsec_rare_conversation_in",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.conversation.id"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_conversation_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.server.ip.addr$"
          },
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "outbound"
      ],
      "description": "Rare Conversation - outbound",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Conversation",
            "function": "rare",
            "by_field_name": "flow.conversation.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.conversation.id",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_conversation_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_conversation_out",
      "job_id": "elastiflow_codex_netsec_rare_conversation_out",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.conversation.id"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_conversation_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.conversation.id,negate:!f,params:(query:'$flow.conversation.id$'),type:phrase),query:(match_phrase:(flow.conversation.id:'$flow.conversation.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "private"
      ],
      "description": "Rare Conversation - private",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Conversation",
            "function": "rare",
            "by_field_name": "flow.conversation.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.conversation.id",
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "8192mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_conversation_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_conversation_priv",
      "job_id": "elastiflow_codex_netsec_rare_conversation_priv",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.conversation.id"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_geo_country_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.geo.country.name,negate:!f,params:(query:'$flow.client.geo.country.name$'),type:phrase),query:(match_phrase:(flow.client.geo.country.name:'$flow.client.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.geo.country.name,negate:!f,params:(query:'$flow.client.geo.country.name$'),type:phrase),query:(match_phrase:(flow.client.geo.country.name:'$flow.client.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.geo.country.name,negate:!f,params:(query:'$flow.client.geo.country.name$'),type:phrase),query:(match_phrase:(flow.client.geo.country.name:'$flow.client.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "inbound"
      ],
      "description": "Rare Country - inbound",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Country",
            "function": "rare",
            "by_field_name": "flow.client.geo.country.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.geo.country.name",
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_geo_country_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_geo_country_in",
      "job_id": "elastiflow_codex_netsec_rare_geo_country_in",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.geo.country.name"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_geo_country_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.geo.country.name,negate:!f,params:(query:'$flow.server.geo.country.name$'),type:phrase),query:(match_phrase:(flow.server.geo.country.name:'$flow.server.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.geo.country.name,negate:!f,params:(query:'$flow.server.geo.country.name$'),type:phrase),query:(match_phrase:(flow.server.geo.country.name:'$flow.server.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.geo.country.name,negate:!f,params:(query:'$flow.server.geo.country.name$'),type:phrase),query:(match_phrase:(flow.server.geo.country.name:'$flow.server.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "outbound"
      ],
      "description": "Rare Country - outbound",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Country",
            "function": "rare",
            "by_field_name": "flow.server.geo.country.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.geo.country.name",
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_geo_country_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_geo_country_out",
      "job_id": "elastiflow_codex_netsec_rare_geo_country_out",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.server.geo.country.name"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_rare_geo_country_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.geo.country.name,negate:!f,params:(query:'$flow.client.geo.country.name$'),type:phrase),query:(match_phrase:(flow.client.geo.country.name:'$flow.client.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.geo.country.name,negate:!f,params:(query:'$flow.client.geo.country.name$'),type:phrase),query:(match_phrase:(flow.client.geo.country.name:'$flow.client.geo.country.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "activity",
        "private"
      ],
      "description": "Rare Country - private",
      "analysis_config": {
        "bucket_span": "30m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Rare Country",
            "function": "rare",
            "by_field_name": "flow.client.geo.country.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.geo.country.name",
          "flow.server.l4.port.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.client.ip.addr",
          "flow.client.host.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_rare_geo_country_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_rare_geo_country_priv",
      "job_id": "elastiflow_codex_netsec_rare_geo_country_priv",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.client.geo.country.name"
              }
            },
            {
              "term": {
                "l4.session.established": "true"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "edge"
      ],
      "description": "SYN Flood DDoS Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_ddos_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_ddos_edge",
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "inbound"
      ],
      "description": "SYN Flood DDoS Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_ddos_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_ddos_in",
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "outbound"
      ],
      "description": "SYN Flood DDoS Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_ddos_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_ddos_out",
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "private"
      ],
      "description": "SYN Flood DDoS Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Senders",
            "function": "high_distinct_count",
            "field_name": "flow.client.ip.addr",
            "by_field_name": "flow.server.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_ddos_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_ddos_priv",
      "job_id": "elastiflow_codex_netsec_syn_flood_ddos_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_edge",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "edge"
      ],
      "description": "SYN Flood Direct Attack - edge",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.server.ip.addr",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_direct_edge",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_direct_edge",
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_edge",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_in",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "RiskIQ PassiveTotal",
            "url_value": "https://community.riskiq.com/research?query=$flow.client.ip.addr$"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "inbound"
      ],
      "description": "SYN Flood Direct Attack - inbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.server.ip.addr",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_direct_in",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_direct_in",
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_in",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_out",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "outbound"
      ],
      "description": "SYN Flood Direct Attack - outbound",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.server.ip.addr",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_direct_out",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_direct_out",
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_out",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.client.as.org": "PRIVATE"
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "flow.server.as.org": "PRIVATE"
              }
            },
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_priv",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.type,negate:!f,params:!(ipfix,netflow),type:phrases,value:'ipfix,%20netflow'),query:(bool:(minimum_should_match:1,should:!((match_phrase:(flow.export.type:ipfix)),(match_phrase:(flow.export.type:netflow)))))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:tcp.flags.bits,negate:!f,params:(query:'2'),type:phrase),query:(match_phrase:(tcp.flags.bits:'2'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.ip.addr,negate:!f,params:(query:'$flow.server.ip.addr$'),type:phrase),query:(match_phrase:(flow.server.ip.addr:'$flow.server.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.client.ip.addr,negate:!f,params:(query:'$flow.client.ip.addr$'),type:phrase),query:(match_phrase:(flow.client.ip.addr:'$flow.client.ip.addr$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.server.l4.port.id,negate:!f,params:(query:'$flow.server.l4.port.id$'),type:phrase),query:(match_phrase:(flow.server.l4.port.id:'$flow.server.l4.port.id$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "security",
        "ddos",
        "flood",
        "private"
      ],
      "description": "SYN Flood Direct Attack - private",
      "analysis_config": {
        "bucket_span": "5m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Excessive SYN Packets",
            "function": "high_sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.server.ip.addr",
            "over_field_name": "flow.client.ip.addr",
            "partition_field_name": "flow.server.l4.port.id",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.client.ip.addr",
          "flow.client.host.name",
          "flow.server.ip.addr",
          "flow.server.host.name",
          "flow.server.l4.port.id"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "512mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_netsec_syn_flood_direct_priv",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_netsec_syn_flood_direct_priv",
      "job_id": "elastiflow_codex_netsec_syn_flood_direct_priv",
      "query": {
        "bool": {
          "must": [
            {
              "term": {
                "tcp.flags.bits": 2
              }
            },
            {
              "terms": {
                "flow.export.type": [
                  "netflow",
                  "ipfix"
                ]
              }
            },
            {
              "exists": {
                "field": "flow.client.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.ip.addr"
              }
            },
            {
              "exists": {
                "field": "flow.server.l4.port.id"
              }
            },
            {
              "term": {
                "flow.locality": "private"
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "flow.client.ip.addr": []
              }
            },
            {
              "terms": {
                "flow.server.ip.addr": []
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_bytes",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Destination ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Destination ASN Bytes",
            "function": "sum",
            "field_name": "flow.bytes",
            "partition_field_name": "flow.dst.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_dst_thruput_bytes",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_dst_thruput_bytes",
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_bytes",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.dst.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_flows",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Destination ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Destination ASN Flows",
            "function": "count",
            "partition_field_name": "flow.dst.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_dst_thruput_flows",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_dst_thruput_flows",
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_flows",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.dst.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_packets",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.dst.as.label,negate:!f,params:(query:'$flow.dst.as.label$'),type:phrase),query:(match_phrase:(flow.dst.as.label:'$flow.dst.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Destination ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Destination ASN Packets",
            "function": "sum",
            "field_name": "flow.packets",
            "partition_field_name": "flow.dst.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.dst.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_dst_thruput_packets",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_dst_thruput_packets",
      "job_id": "elastiflow_codex_perf_asn_dst_thruput_packets",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.dst.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_src_thruput_bytes",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Source ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Source ASN Bytes",
            "function": "sum",
            "field_name": "flow.bytes",
            "partition_field_name": "flow.src.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_src_thruput_bytes",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_src_thruput_bytes",
      "job_id": "elastiflow_codex_perf_asn_src_thruput_bytes",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_src_thruput_flows",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Source ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Source ASN Flows",
            "function": "count",
            "partition_field_name": "flow.src.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_src_thruput_flows",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_src_thruput_flows",
      "job_id": "elastiflow_codex_perf_asn_src_thruput_flows",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_asn_src_thruput_packets",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.src.as.label,negate:!f,params:(query:'$flow.src.as.label$'),type:phrase),query:(match_phrase:(flow.src.as.label:'$flow.src.as.label$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Source ASN Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Source ASN Packets",
            "function": "sum",
            "field_name": "flow.packets",
            "partition_field_name": "flow.src.as.label",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.src.as.label",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "1024mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_asn_src_thruput_packets",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_asn_src_thruput_packets",
      "job_id": "elastiflow_codex_perf_asn_src_thruput_packets",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.src.as.label"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_bytes",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Egress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Egress Bytes",
            "function": "sum",
            "field_name": "flow.bytes",
            "by_field_name": "flow.out.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.out.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_egress_thruput_bytes",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_egress_thruput_bytes",
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_bytes",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.out.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_flows",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Egress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Egress Flows",
            "function": "count",
            "by_field_name": "flow.out.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.out.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_egress_thruput_flows",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_egress_thruput_flows",
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_flows",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.out.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_packets",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.out.netif.name,negate:!f,params:(query:'$flow.out.netif.name$'),type:phrase),query:(match_phrase:(flow.out.netif.name:'$flow.out.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Egress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Egress Packets",
            "function": "sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.out.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.out.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_egress_thruput_packets",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_egress_thruput_packets",
      "job_id": "elastiflow_codex_perf_netif_egress_thruput_packets",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.out.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_bytes",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Ingress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Ingress Bytes",
            "function": "sum",
            "field_name": "flow.bytes",
            "by_field_name": "flow.in.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.in.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_ingress_thruput_bytes",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_ingress_thruput_bytes",
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_bytes",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.in.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_flows",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Ingress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Ingress Flows",
            "function": "count",
            "by_field_name": "flow.in.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.in.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_ingress_thruput_flows",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_ingress_thruput_flows",
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_flows",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.in.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  },
  {
    "job": {
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_packets",
      "custom_settings": {
        "custom_urls": [
          {
            "url_name": "Top Talkers",
            "url_value": "dashboards#/view/a000b640-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Exporters (traffic)",
            "url_value": "dashboards#/view/6fa91cc0-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Threats",
            "url_value": "dashboards#/view/f7fbc0b0-3d3e-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          },
          {
            "url_name": "Flow Records",
            "url_value": "dashboards#/view/abfed250-3d3f-11eb-bc2c-c5758316d788?_g=(filters:!(('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.export.host.name,negate:!f,params:(query:'$flow.export.host.name$'),type:phrase),query:(match_phrase:(flow.export.host.name:'$flow.export.host.name$'))),('$state':(store:globalState),meta:(alias:!n,disabled:!f,index:'elastiflow-flow-codex-*',key:flow.in.netif.name,negate:!f,params:(query:'$flow.in.netif.name$'),type:phrase),query:(match_phrase:(flow.in.netif.name:'$flow.in.netif.name$')))),refreshInterval:(pause:!t,value:0),time:(mode:absolute,from:'$earliest$',to:'$latest$'))"
          }
        ]
      },
      "groups": [
        "elastiflow",
        "performance"
      ],
      "description": "Unusual Ingress Traffic Volume",
      "analysis_config": {
        "bucket_span": "15m",
        "model_prune_window": "14d",
        "detectors": [
          {
            "detector_description": "Unusual Ingress Packets",
            "function": "sum",
            "field_name": "flow.packets",
            "by_field_name": "flow.in.netif.name",
            "partition_field_name": "flow.export.host.name",
            "detector_index": 0
          }
        ],
        "influencers": [
          "flow.export.host.name",
          "flow.in.netif.name",
          "flow.src.ip.addr",
          "flow.src.host.name",
          "flow.src.l4.port.name",
          "flow.dst.ip.addr",
          "flow.dst.host.name",
          "flow.dst.l4.port.name"
        ]
      },
      "analysis_limits": {
        "model_memory_limit": "2048mb",
        "categorization_examples_limit": 4
      },
      "data_description": {
        "time_field": "@timestamp",
        "time_format": "epoch_ms"
      },
      "model_plot_config": {
        "enabled": true,
        "annotations_enabled": true
      },
      "model_snapshot_retention_days": 7,
      "daily_model_snapshot_retention_after_days": 1,
      "results_index_name": "custom-elastiflow_codex_perf_netif_ingress_thruput_packets",
      "allow_lazy_open": false
    },
    "datafeed": {
      "datafeed_id": "datafeed-elastiflow_codex_perf_netif_ingress_thruput_packets",
      "job_id": "elastiflow_codex_perf_netif_ingress_thruput_packets",
      "query": {
        "bool": {
          "must": [
            {
              "exists": {
                "field": "flow.in.netif.name"
              }
            },
            {
              "exists": {
                "field": "flow.export.host.name"
              }
            }
          ]
        }
      },
      "indices": [
        "elastiflow-flow-codex-*"
      ],
      "scroll_size": 1000,
      "delayed_data_check_config": {
        "enabled": true
      }
    }
  }
]